<!DOCTYPE HTML>
<html lang="en">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="2-spanish_translation AB test, Naixin&#39;s blog">
    <meta name="baidu-site-verification" content>
    <meta name="google-site-verification" content>
    <meta name="360-site-verification" content>
    <meta name="description" content="This notebook details the approaches and the conclusions of how I approached verifying the results of an A/B Test. The t">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>2-spanish_translation AB test | Naixin&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Naixin's blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <span>Home</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <span>Learning notes</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <span>About</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <span>Courses</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/contact" class="waves-effect waves-light">
            
            <span>Contact</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="Search"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Naixin's blog</div>
        <div class="logo-desc">
            
            You never lose, you either win or learn.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-link"></i>
                
                Home
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-link"></i>
                
                Learning notes
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-link"></i>
                
                About
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-link"></i>
                
                Courses
            </a>
        </li>
        
        <li>
            <a href="/contact" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-link"></i>
                
                Contact
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/naixinzhang" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/naixinzhang" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        2-spanish_translation AB test
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/Python-Take-home-challenge/" target="_blank">
                            <span class="chip bg-color">Python_Take home challenge</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/Take-home-data-challenge/" class="post-category" target="_blank">
                            Take home data challenge
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2018-01-23
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>Author:&nbsp;&nbsp;
                    
                    Naixin Zhang
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>Word Count:&nbsp;&nbsp;
                    2.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>Read Times:&nbsp;&nbsp;
                    17 Min
                </div>
                
                

                
                <div id="busuanzi_container_page_pv" class="info-break-policy">
                    <i class="fa fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv"></span>
                </div>
                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>This notebook details the approaches and the conclusions of how I approached verifying the results of an A/B Test. The test measured conversion rates when a website used custom language tamplates for spanish speaking countries compared to the same template (a Spain dialect translation) for all countries. We would think that custom templates would do better but that was not the case, the results point to the same template increasing conversions. So in this notebook I seek to see if the test can be trusted and if not what could be done differently for the next test.</p>
<p>This notebook covers:</p>
<ul>
<li>Data Cleaning</li>
<li>Verifying Results</li>
<li>Using Statistical Tools to test for Sample Bias</li>
</ul>
<p>Conclusions:</p>
<ul>
<li>If the results seem unbelievable, they probably are. We intuitively know that a custom website for each region would yield better results. So when it didn’t it’s important to take extra precautions to make sure that the test was run appropriately, in this case we found that the test sample wasn’t indicative of the population</li>
<li>The test was misleading because suffered from sample bias and a possible small sample size which needs to be addressed.</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> ttest_ind
<span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats

<span class="token operator">%</span>matplotlib inline<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>stats<span class="token punctuation">.</span>weightstats <span class="token keyword">import</span> ttest_ind <span class="token keyword">as</span> sm_ttest
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>stats<span class="token punctuation">.</span>weightstats <span class="token keyword">import</span> zconfint <span class="token keyword">as</span> sm_confint

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder<span class="token punctuation">,</span> OneHotEncoder<span class="token punctuation">,</span> LabelBinarizer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier<span class="token punctuation">,</span> export_graphviz<span class="token punctuation">,</span> DecisionTreeRegressor

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>dates <span class="token keyword">as</span> mdates
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> rcParams
<span class="token keyword">from</span> pydotplus <span class="token keyword">import</span> graph_from_dot_data
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> Image
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'precision'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test_table.csv'</span><span class="token punctuation">)</span>
user_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'user_table.csv'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">test_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>date</th>
      <th>source</th>
      <th>device</th>
      <th>browser_language</th>
      <th>ads_channel</th>
      <th>browser</th>
      <th>conversion</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>315281</td>
      <td>2015-12-03</td>
      <td>Direct</td>
      <td>Web</td>
      <td>ES</td>
      <td>NaN</td>
      <td>IE</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>497851</td>
      <td>2015-12-04</td>
      <td>Ads</td>
      <td>Web</td>
      <td>ES</td>
      <td>Google</td>
      <td>IE</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>848402</td>
      <td>2015-12-04</td>
      <td>Ads</td>
      <td>Web</td>
      <td>ES</td>
      <td>Facebook</td>
      <td>Chrome</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>290051</td>
      <td>2015-12-03</td>
      <td>Ads</td>
      <td>Mobile</td>
      <td>Other</td>
      <td>Facebook</td>
      <td>Android_App</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>548435</td>
      <td>2015-11-30</td>
      <td>Ads</td>
      <td>Web</td>
      <td>ES</td>
      <td>Google</td>
      <td>FireFox</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<pre class="line-numbers language-python"><code class="language-python">test_df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 453321 entries, 0 to 453320
Data columns (total 9 columns):
user_id             453321 non-null int64
date                453321 non-null object
source              453321 non-null object
device              453321 non-null object
browser_language    453321 non-null object
ads_channel         181877 non-null object
browser             453321 non-null object
conversion          453321 non-null int64
test                453321 non-null int64
dtypes: int64(3), object(6)
memory usage: 31.1+ MB</code></pre><pre class="line-numbers language-python"><code class="language-python">user_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>sex</th>
      <th>age</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>765821</td>
      <td>M</td>
      <td>20</td>
      <td>Mexico</td>
    </tr>
    <tr>
      <th>1</th>
      <td>343561</td>
      <td>F</td>
      <td>27</td>
      <td>Nicaragua</td>
    </tr>
    <tr>
      <th>2</th>
      <td>118744</td>
      <td>M</td>
      <td>23</td>
      <td>Colombia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>987753</td>
      <td>F</td>
      <td>27</td>
      <td>Venezuela</td>
    </tr>
    <tr>
      <th>4</th>
      <td>554597</td>
      <td>F</td>
      <td>20</td>
      <td>Spain</td>
    </tr>
  </tbody>
</table>
</div>




<pre class="line-numbers language-python"><code class="language-python">user_df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 452867 entries, 0 to 452866
Data columns (total 4 columns):
user_id    452867 non-null int64
sex        452867 non-null object
age        452867 non-null int64
country    452867 non-null object
dtypes: int64(2), object(2)
memory usage: 13.8+ MB</code></pre><p>Steps:</p>
<ul>
<li>Join the Tables on the common column user_id</li>
<li>Check for Null Values</li>
<li>Deal with Null Values</li>
</ul>
<h2 id="1-join-data"><a href="#1-join-data" class="headerlink" title="1.join data"></a>1.join data</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># check the two tables uniqueness</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test ID:\t'</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>test_df<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>test_df<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>test_df<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'User ID:\t'</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>user_df<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>user_df<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>user_df<span class="token punctuation">)</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre><code>Test ID:     453321      True
User ID:     452867      True</code></pre><pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> test_df<span class="token punctuation">.</span>join<span class="token punctuation">(</span>user_df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'user_id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">data<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 453321 entries, 0 to 453320
Data columns (total 12 columns):
user_id             453321 non-null int64
date                453321 non-null object
source              453321 non-null object
device              453321 non-null object
browser_language    453321 non-null object
ads_channel         181877 non-null object
browser             453321 non-null object
conversion          453321 non-null int64
test                453321 non-null int64
sex                 452867 non-null object
age                 452867 non-null float64
country             452867 non-null object
dtypes: float64(1), int64(3), object(8)
memory usage: 41.5+ MB</code></pre><h2 id="2-check-null-value"><a href="#2-check-null-value" class="headerlink" title="2. check null value"></a>2. check null value</h2><pre class="line-numbers language-python"><code class="language-python">np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>user_id                  0
date                     0
source                   0
device                   0
browser_language         0
ads_channel         271444
browser                  0
conversion               0
test                     0
sex                    454
age                    454
country                454
dtype: int64</code></pre><ul>
<li>There are null values in 3 columns: sex, age, country, and ads channel</li>
<li>We will delete the rows with null values for sex, age and country because it’s so few.</li>
<li>Since there are so many missing values for ads_channel we will fill create a different colum that raises a 1 when it’s a null value and a 0 when it’s not. </li>
<li>We will investigate the ads_channel to determine whether to erase it or not.</li>
</ul>
<h2 id="3-dealing-with-null-values"><a href="#3-dealing-with-null-values" class="headerlink" title="3. dealing with null values"></a>3. dealing with null values</h2><pre class="line-numbers language-python"><code class="language-python">data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>sex<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>date</th>
      <th>source</th>
      <th>device</th>
      <th>browser_language</th>
      <th>ads_channel</th>
      <th>browser</th>
      <th>conversion</th>
      <th>test</th>
      <th>sex</th>
      <th>age</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>819</th>
      <td>657841</td>
      <td>2015-12-02</td>
      <td>Ads</td>
      <td>Mobile</td>
      <td>ES</td>
      <td>Bing</td>
      <td>Android_App</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1696</th>
      <td>859340</td>
      <td>2015-12-04</td>
      <td>Direct</td>
      <td>Mobile</td>
      <td>EN</td>
      <td>NaN</td>
      <td>Android_App</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1934</th>
      <td>716487</td>
      <td>2015-12-04</td>
      <td>SEO</td>
      <td>Mobile</td>
      <td>ES</td>
      <td>NaN</td>
      <td>Android_App</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2409</th>
      <td>87209</td>
      <td>2015-12-01</td>
      <td>Direct</td>
      <td>Web</td>
      <td>ES</td>
      <td>NaN</td>
      <td>Chrome</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2721</th>
      <td>771642</td>
      <td>2015-11-30</td>
      <td>SEO</td>
      <td>Mobile</td>
      <td>ES</td>
      <td>NaN</td>
      <td>Android_App</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



<p>The missing values for sex,age, and country are all the same 454 rows so we will get rid of them</p>
<pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>data<span class="token punctuation">.</span>index<span class="token punctuation">.</span>difference<span class="token punctuation">(</span>data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>sex<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'ads_channel_is_null'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token boolean">True</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">.</span>ads_channel<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python">np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>user_id                     0
date                        0
source                      0
device                      0
browser_language            0
ads_channel            271174
browser                     0
conversion                  0
test                        0
sex                         0
age                         0
country                     0
ads_channel_is_null         0
dtype: int64</code></pre><h2 id="First-question-check-test-results"><a href="#First-question-check-test-results" class="headerlink" title="First question: check test results."></a>First question: check test results.</h2><p>But even before that, let’s make sure it is true Spain coverts much better than rest of LatAm countries</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># First check that Spain converts much better than the rest of LatAm countries</span>
groupby_country <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">,</span> <span class="token string">'country'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'country'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
groupby_country <span class="token operator">=</span> groupby_country<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
groupby_country <span class="token operator">=</span> groupby_country<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'conversion'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Visualization</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'country'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'conversion'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>groupby_country<span class="token punctuation">,</span> ax<span class="token operator">=</span>ax<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="2_26_0.png" alt="png"></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Visualization</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'country'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'conversion'</span><span class="token punctuation">,</span> hue<span class="token operator">=</span><span class="token string">'test'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> ax<span class="token operator">=</span>ax<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="2_27_0.png" alt="png"></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># A/B test</span>
data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'Spain'</span><span class="token punctuation">]</span>
test_val <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
cont_val <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values

<span class="token keyword">print</span><span class="token punctuation">(</span>test_val<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> cont_val<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>0.043411161678422794      0.04829179055749524</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>ttest_ind<span class="token punctuation">(</span>test_val<span class="token punctuation">,</span> cont_val<span class="token punctuation">,</span> equal_var<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>Ttest_indResult(statistic=-7.353895203080277, pvalue=1.9289178577799033e-13)</code></pre><p>Mmh..not in the test are converting at 4.8% while users in the test just at 4.3%.That’s a 10% drop, which should be dramatic if it were true. The most likely reason for weired A/B test results are:</p>
<ul>
<li>we didn’t collect enough data</li>
<li>some bias has been introduce in the experiment so that test/control people are not really random</li>
</ul>
<p>Firstly, let’s plot day by day, to see if these weird results have been constantly happening or they just started happening all of a sudden</p>
<pre class="line-numbers language-python"><code class="language-python">data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data_test_by_day <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>test<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">]</span><span class="token operator">/</span>data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>test<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data_test_by_day<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'test_vs_control'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data_test_by_day<span class="token punctuation">.</span>index<span class="token punctuation">,</span> data_test_by_day<span class="token punctuation">.</span>test_vs_control<span class="token punctuation">)</span><span class="token punctuation">;</span>
plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_major_locator<span class="token punctuation">(</span>mdates<span class="token punctuation">.</span>DayLocator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_major_formatter<span class="token punctuation">(</span>mdates<span class="token punctuation">.</span>DateFormatter<span class="token punctuation">(</span><span class="token string">'%b %d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'test_vs_control'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Test Conversion in Relation to Control Conversion'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>C:\Users\Naixin\Anaconda3\lib\site-packages\pandas\plotting\_converter.py:129: FutureWarning: Using an implicitly registered datetime converter for a matplotlib plotting method. The converter was registered by pandas on import. Future versions of pandas will require you to explicitly register matplotlib converters.

To register the converters:
    &gt;&gt;&gt; from pandas.plotting import register_matplotlib_converters
    &gt;&gt;&gt; register_matplotlib_converters()
  warnings.warn(msg, FutureWarning)





Text(0.5, 1.0, &#39;Test Conversion in Relation to Control Conversion&#39;)</code></pre><p><img src="2_32_2.png" alt="png"></p>
<p>From this plot, we notice a couple of things:</p>
<ul>
<li>The Control sample consistently under-performs throughout the 5 days</li>
<li>It is trending upward which could be a sign that the a/b test was for too short a time span</li>
</ul>
<p>To prove if the test was valid we can check for two things:</p>
<ul>
<li>Small Sample Size</li>
<li>Sample Bias</li>
</ul>
<p>We already saw that the test ran for 5 days in which the test sample was beginning to trend upwards, so that could be the culprit. However, we cannot know so we can look to bias get a further understanding.</p>
<p>For the a/b test to be valid, both the control and test sample have to be the same except for the one feature. If they are not then the effect of another feature could of caused the change in conversion. 
So here we will use three tools:</p>
<ul>
<li>We will plot the distributions of each feature in for the test and control</li>
<li>We will use a decision tree to see if any feature can predict whether a data point is in a test or control (it shouldn’t!)</li>
<li>We will use a t-test to verify results</li>
</ul>
<h1 id="1-Distribution-of-Columns-in-Relation-to-Test-or-Control-Sample"><a href="#1-Distribution-of-Columns-in-Relation-to-Test-or-Control-Sample" class="headerlink" title="1. Distribution of Columns in Relation to Test or Control Sample"></a>1. Distribution of Columns in Relation to Test or Control Sample</h1><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Let's look at each feature's conversion in relation</span>
<span class="token comment" spellcheck="true">#to whether it's a test or control sample</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>difference<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sns<span class="token punctuation">.</span>factorplot<span class="token punctuation">(</span>i<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">'count'</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">'test'</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> aspect <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>C:\Users\Naixin\Anaconda3\lib\site-packages\seaborn\categorical.py:3666: UserWarning: The `factorplot` function has been renamed to `catplot`. The original name will be removed in a future release. Please update your code. Note that the default `kind` in `factorplot` (`&#39;point&#39;`) has changed `&#39;strip&#39;` in `catplot`.
  warnings.warn(msg)
C:\Users\Naixin\Anaconda3\lib\site-packages\seaborn\categorical.py:3672: UserWarning: The `size` paramter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)</code></pre><p><img src="2_35_1.png" alt="png"></p>
<p><img src="2_35_2.png" alt="png"></p>
<p><img src="2_35_3.png" alt="png"></p>
<p><img src="2_35_4.png" alt="png"></p>
<p><img src="2_35_5.png" alt="png"></p>
<p><img src="2_35_6.png" alt="png"></p>
<p><img src="2_35_7.png" alt="png"></p>
<p><img src="2_35_8.png" alt="png"></p>
<p><img src="2_35_9.png" alt="png"></p>
<p><img src="2_35_10.png" alt="png"></p>
<p><img src="2_35_11.png" alt="png"></p>
<ul>
<li>There is no clear difference between the control and test sample for each features</li>
<li>There seem to make small differences between age and countries but it’s not definite.</li>
<li>The new feature we made for the null values seems to have no effect.</li>
</ul>
<h1 id="2-Training-a-Model-To-Test-for-Bias"><a href="#2-Training-a-Model-To-Test-for-Bias" class="headerlink" title="2. Training a Model To Test for Bias"></a>2. Training a Model To Test for Bias</h1><p>Here we will use a random forrest classifier to see if any features become significant in predicting whether a data point is in a test or control sample. We will make the test column the dependent variable and the rest of the features conversion as independent variables.</p>
<h3 id="This-process-can-be-fully-automated-in-the-future-and-give-a-warning-when-an-a-b-test-may-contain-sample-bias"><a href="#This-process-can-be-fully-automated-in-the-future-and-give-a-warning-when-an-a-b-test-may-contain-sample-bias" class="headerlink" title="This process can be fully automated in the future and give a warning when an a/b test may contain sample bias!"></a>This process can be fully automated in the future and give a warning when an a/b test may contain sample bias!</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Create a New Dataframe without the conversion column</span>
tree_df <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>difference<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'conversion'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Create dummy variables for categorical values</span>
ads_channel_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>ads_channel<span class="token punctuation">,</span> prefix<span class="token operator">=</span> <span class="token string">'ads'</span><span class="token punctuation">)</span>
browser_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>browser<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'browser'</span><span class="token punctuation">)</span>
browser_language_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>browser_language<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'browser_language'</span><span class="token punctuation">)</span>
country_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>country<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'country'</span><span class="token punctuation">)</span>
device_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>device<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'device'</span><span class="token punctuation">)</span>
sex_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>sex<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'sex'</span><span class="token punctuation">)</span>
source_dums <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>tree_df<span class="token punctuation">.</span>source<span class="token punctuation">,</span>prefix<span class="token operator">=</span> <span class="token string">'source'</span><span class="token punctuation">)</span>

dums_list <span class="token operator">=</span> <span class="token punctuation">[</span>ads_channel_dums<span class="token punctuation">,</span> browser_dums<span class="token punctuation">,</span>browser_language_dums<span class="token punctuation">,</span>country_dums<span class="token punctuation">,</span>device_dums<span class="token punctuation">,</span>sex_dums<span class="token punctuation">,</span>source_dums <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Training the Tree</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
X <span class="token operator">=</span> tree_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>dums_list<span class="token punctuation">)</span>
y <span class="token operator">=</span> tree_df<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span>
tree <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
tree<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
                       max_features=None, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=False,
                       random_state=None, splitter=&#39;best&#39;)</code></pre><pre class="line-numbers language-python"><code class="language-python">features_significance<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>country_Argentina</td>
      <td>0.21</td>
    </tr>
    <tr>
      <th>30</th>
      <td>country_Uruguay</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>35</th>
      <td>sex_M</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>34</th>
      <td>sex_F</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>13</th>
      <td>browser_language_EN</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ads_Google</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>14</th>
      <td>browser_language_ES</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>15</th>
      <td>browser_language_Other</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ads_Yahoo</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>29</th>
      <td>country_Peru</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>31</th>
      <td>country_Venezuela</td>
      <td>0.02</td>
    </tr>
  </tbody>
</table>
</div>




<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># ploting</span>
features_significance <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'features'</span><span class="token punctuation">:</span> X<span class="token punctuation">.</span>columns<span class="token punctuation">,</span>\
          <span class="token string">'importance'</span><span class="token punctuation">:</span> tree<span class="token punctuation">.</span>feature_importances_<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'importance'</span><span class="token punctuation">,</span> ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">]</span>

_ <span class="token operator">=</span> sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'features'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'importance'</span>
                  <span class="token punctuation">,</span>data <span class="token operator">=</span> features_significance<span class="token punctuation">,</span> orient <span class="token operator">=</span> <span class="token string">'v'</span><span class="token punctuation">)</span>
_<span class="token punctuation">.</span>figure<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="2_44_0.png" alt="png"></p>
<ul>
<li>There is one very predictive features: whether country is Argentina</li>
<li>This is a signal for bias so we can verify with T-tests</li>
</ul>
<h1 id="3-using-T-tests-to-verify-results"><a href="#3-using-T-tests-to-verify-results" class="headerlink" title="3. using T-tests to verify results"></a>3. using T-tests to verify results</h1><p>Approach:</p>
<ul>
<li><p>We will then verify the power of these features by running t-tests on country</p>
</li>
<li><p>We will conclude that there is bias in the data if the data comes back non-significant for the features </p>
</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">##1. Running T-Test</span>
country <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
conversion_test <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
conversion_control <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
ttest_vals<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
p_vals <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">.</span>country<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">:</span>
    temp <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>country <span class="token operator">==</span> i<span class="token punctuation">]</span>
    cat1 <span class="token operator">=</span> temp<span class="token punctuation">[</span>data<span class="token punctuation">.</span>test <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>conversion
    cat2 <span class="token operator">=</span> temp<span class="token punctuation">[</span>data<span class="token punctuation">.</span>test <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>conversion
    ttest<span class="token punctuation">,</span> p <span class="token operator">=</span>stats<span class="token punctuation">.</span>ttest_ind<span class="token punctuation">(</span>cat2<span class="token punctuation">,</span> cat1<span class="token punctuation">)</span>
    country<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    conversion_test<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cat1<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>float<span class="token punctuation">(</span>len<span class="token punctuation">(</span>cat1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    conversion_control<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cat2<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>float<span class="token punctuation">(</span>len<span class="token punctuation">(</span>cat2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    ttest_vals<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ttest<span class="token punctuation">)</span>
    p_vals<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'country'</span><span class="token punctuation">:</span> country<span class="token punctuation">,</span> 
              <span class="token string">'conversion_test'</span><span class="token punctuation">:</span> conversion_test<span class="token punctuation">,</span>
              <span class="token string">'conversion_control'</span><span class="token punctuation">:</span> conversion_control<span class="token punctuation">,</span>
             <span class="token string">'p_value'</span><span class="token punctuation">:</span> p_vals<span class="token punctuation">}</span><span class="token punctuation">)</span>\
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'country'</span><span class="token punctuation">,</span> <span class="token string">'p_value'</span><span class="token punctuation">,</span> <span class="token string">'conversion_test'</span><span class="token punctuation">,</span> <span class="token string">'conversion_control'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>C:\Users\Naixin\Anaconda3\lib\site-packages\ipykernel_launcher.py:9: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  if __name__ == &#39;__main__&#39;:
C:\Users\Naixin\Anaconda3\lib\site-packages\ipykernel_launcher.py:10: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  # Remove the CWD from sys.path while we load stuff.</code></pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>p_value</th>
      <th>conversion_test</th>
      <th>conversion_control</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mexico</td>
      <td>0.17</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colombia</td>
      <td>0.42</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Argentina</td>
      <td>0.32</td>
      <td>0.01</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Peru</td>
      <td>0.77</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Venezuela</td>
      <td>0.57</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Chile</td>
      <td>0.30</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ecuador</td>
      <td>0.96</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Guatemala</td>
      <td>0.57</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Bolivia</td>
      <td>0.72</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Honduras</td>
      <td>0.47</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>10</th>
      <td>El Salvador</td>
      <td>0.25</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Paraguay</td>
      <td>0.88</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Nicaragua</td>
      <td>0.78</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Costa Rica</td>
      <td>0.69</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Uruguay</td>
      <td>0.88</td>
      <td>0.01</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Panama</td>
      <td>0.71</td>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>



<p>After control for country, the test clearly appears non-significant.Not a great success given that the goal was to impove conversion rate, but at least we know that a localized translation didn’t make things worse.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p><b>1. If the Results Seem Unbelievable, They Probably Are  </b></p>
<ul>
<li>We intuitively know that a custom website for each region would yield better results. So when it didn’t it’s important to take extra precautions to make sure that the test was run appropriately, in this case we found that the test sample wasn’t indicative of the population</li>
</ul>
<p><b>2. We can Automate This Process Using Machine Learning  </b></p>
<ul>
<li>By building a model that can show us if any features can predict whether a user is in the test or control sample, we can automate the process. We can set a threshold for feature significance and let the model tell us automatically if the sample is biased or not! This gives us more time to deal with deeper subjects. 3. By simply looking at feature distributions, we miss the subtly of sample bias</li>
<li>When we saw the distribution of features, all the features seemed balanced. There were a little discrepancies in country but aged seemed balanced. If we had not run T-test or the decision tree to prove statistical significance then we would of missed country as the major indicator of a biased data set. When running an A/B test, the quality of the test is just important if not more important than the results.</li>
</ul>
<p><b>There are many ways to test bias but I’m going to try 2 here:</b>
a. Train a to see if it can predict whether it’s the test or control sample
(if the sample is unbiased then no features should be predictive)
b. : A t-test should reveal whether a feature’s effect on conversion is statistically significant</p>

            </div>
            <hr />

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone, qq, weibo, douban"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            


        </div>
    </div>

    
    <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'c090019fe3f06f8ef15d',
        clientSecret: '9f220a5e71efc340544fce7ae397f63151db8747',
        repo: 'naixinzhang.github.io',
        owner: 'naixinzhang',
        admin: "naixinzhang",
        id: '2018/01/23/2-spanish-translation-ab-test/',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    
    <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<!-- <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script> -->

<script>
    new Valine({
        el: '#vcomments',
        appId: '',
        appKey: '',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'false' === 'true',
        avatar: 'wavatar',
        pageSize: '10',
        lang: 'en',
        placeholder: '如果你没有GitHub账号，还可以在这里评论啦！'
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2018/01/24/4-identifying-fraudulent-activities/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="4-Identifying Fraudulent activities">
                        
                        <span class="card-title">4-Identifying Fraudulent activities</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            The goal of this challenge is to build a machine learning model that predicts the probability that the first transaction
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2018-01-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Take-home-data-challenge/" class="post-category" target="_blank">
                                    Take home data challenge
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python-Take-home-challenge/" target="_blank">
                        <span class="chip bg-color">Python_Take home challenge</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2018/01/22/1-conversion-rate/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/24.jpg" class="responsive-img" alt="1-converison rate">
                        
                        <span class="card-title">1-converison rate</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            You are asked to :

confirm that the test is actually negative. That is, it appears that the old version of the site wit
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2018-01-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Take-home-data-challenge/" class="post-category" target="_blank">
                                    Take home data challenge
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python-Take-home-challenge/" target="_blank">
                        <span class="chip bg-color">Python_Take home challenge</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


    <footer class="page-footer bg-color center-align">
    <div class="container row center-align">
        <div class="copy-right">
            &copy; 2020 NaixinZhang. All Rights Reserved.
        </div>
    </div>
</footer>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，崩溃啦！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，又好了！", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    
    <script src="/libs/others/clicklove.js"></script>
    

    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    <!-- 雪花特效 -->
    

</body>

</html>